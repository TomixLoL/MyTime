{% extends 'base.html' %}

{% load static %}

{% block content %}

    <section class="bienvenida">
        <!-- Filtro y buscador -->
        <form method="get" action="">

            <!-- Buscador -->
            <div class="buscador">
                <input id="bienvenida-buscador" type="text" name="buscar" placeholder="¿Qué buscas?" value="{{ queryset }}">
                <button id= "bienvenida-encontrar" type="submit">Buscar</button>
            </div>

            <!-- Filtro -->
            <select name="categoria" id="categoria" class="categorias-select" onchange="this.form.submit()">
                <option value="" {% if not categoria_seleccionada %}selected{% endif %}>Todas las categorías</option>
                {% for categoria in categorias %}
                    <option value="{{ categoria.id|stringformat:"s" }}" {% if categoria_seleccionada == categoria.id|stringformat:"s" %}selected{% endif %}>{{ categoria.nombre }}</option>
                {% endfor %}
            </select>
        </form>
        
        <!-- Productos destacados -->
        {% if productos_destacados %}
        <h2>¡Productos destacados!</h2>
        <div class="productos-destacados">
            {% for producto_destacado in productos_destacados %}
                <a href="{% url 'productos:producto_detail' producto_destacado.id %}">
                    <div class="producto-destacado">
                        <img src="{{ producto_destacado.imagen_producto.url }}" alt="{{ producto_destacado.nombre }}">
                        <div class="producto-destacado-info">
                            <h5>{{ producto_destacado.nombre }}</h5>
                            <p class="descripcion">{{ producto_destacado.descripcion }}</p>
                            <p class="precio">${{ producto_destacado.precio }}</p>
                            <button>Comprar</button>
                        </div>
                    </div>
                </a>
            {% endfor %}
        </div>
    {% endif %}

    <!-- Productos generales -->
    <section class="todosProd">
        {% for producto in object_list %}
            <div class="producto">
                <a href="{% url 'productos:producto_detail' producto.id %}">
                    <img src="{{ producto.imagen_producto.url }}" alt="Portada">
                    <div class="card">
                        <h5>{{ producto.nombre }}</h5>
                        <p>{{ producto.precio_formateado }}</p>
                        <button>Añadir</button>
                    </div>
                </a>
            </div>
            
        {% endfor %}
    </section>

{% endblock content%}